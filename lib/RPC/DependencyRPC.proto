syntax = "proto3";

package dra;

// The DependencyRPC service definition.
service DependencyRPC {
    
    rpc GetDependencyInput (Empty) returns (DependencyInput) {
    }
    rpc GetNewInput (Empty) returns (NewInput) {
    }
    rpc GetVmOffsets (Empty) returns (Empty) {
    }
    
    rpc SendDependencyInput (DependencyInput) returns (Empty) {
    }
    rpc SendInput (Input) returns (Empty) {
    }
}

message Empty {
    uint32 address = 1;
}

message RelatedInput {
    string sig = 1; // hash value for each input from syzkaller
    uint32 address = 2;
}

message RelatedSyscall {
    string name = 1;
    uint32 address = 2;
}

message UncoveredAddress {
    uint32 address = 1;
    uint32 idx = 2;
    uint32 condition_address = 3;
    repeated RelatedInput related_input = 4;
    repeated RelatedSyscall related_syscall = 5;
}

message DependencyInput {
    string sig = 1; // hash value for each input from syzkaller
    repeated UncoveredAddress uncovered_address = 2;
}

message Call {
    uint32 idx = 1;
    repeated uint32 address = 2;
}

message Input {
    string sig = 1;
    repeated Call call = 2;
}

message NewInput {
    repeated Input input = 1;
}
